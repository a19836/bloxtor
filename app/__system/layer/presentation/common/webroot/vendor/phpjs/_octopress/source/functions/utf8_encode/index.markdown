---
layout: page
title: "JavaScript utf8_encode function"
comments: true
sharing: true
footer: true
sidebar: false
alias:
- /functions/view/utf8_encode:577
- /functions/view/utf8_encode
- /functions/view/577
- /functions/utf8_encode:577
- /functions/577
---
<!-- Generated by Rakefile:build -->
A JavaScript equivalent of PHP's utf8_encode

{% codeblock xml/utf8_encode.js lang:js https://raw.github.com/kvz/phpjs/master/functions/xml/utf8_encode.js raw on github %}
function utf8_encode (argString) {
  // http://kevin.vanzonneveld.net
  // +   original by: Webtoolkit.info (http://www.webtoolkit.info/)
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   improved by: sowberry
  // +    tweaked by: Jack
  // +   bugfixed by: Onno Marsman
  // +   improved by: Yves Sucaet
  // +   bugfixed by: Onno Marsman
  // +   bugfixed by: Ulrich
  // +   bugfixed by: Rafal Kukawski
  // +   improved by: kirilloid
  // *     example 1: utf8_encode('Kevin van Zonneveld');
  // *     returns 1: 'Kevin van Zonneveld'

  if (argString === null || typeof argString === "undefined") {
    return "";
  }

  var string = (argString + ''); // .replace(/\r\n/g, "\n").replace(/\r/g, "\n");
  var utftext = '',
    start, end, stringl = 0;

  start = end = 0;
  stringl = string.length;
  for (var n = 0; n < stringl; n++) {
    var c1 = string.charCodeAt(n);
    var enc = null;

    if (c1 < 128) {
      end++;
    } else if (c1 > 127 && c1 < 2048) {
      enc = String.fromCharCode((c1 >> 6) | 192, (c1 & 63) | 128);
    } else {
      enc = String.fromCharCode((c1 >> 12) | 224, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128);
    }
    if (enc !== null) {
      if (end > start) {
        utftext += string.slice(start, end);
      }
      utftext += enc;
      start = end = n + 1;
    }
  }

  if (end > start) {
    utftext += string.slice(start, stringl);
  }

  return utftext;
}
{% endcodeblock %}

 - [view on github](https://github.com/kvz/phpjs/blob/master/functions/xml/utf8_encode.js)
 - [edit on github](https://github.com/kvz/phpjs/edit/master/functions/xml/utf8_encode.js)

### Example 1
This code
{% codeblock lang:js example %}
utf8_encode('Kevin van Zonneveld');
{% endcodeblock %}

Should return
{% codeblock lang:js returns %}
'Kevin van Zonneveld'
{% endcodeblock %}


### Other PHP functions in the xml extension
{% render_partial _includes/custom/xml.html %}
## Legacy comments
These were imported from our old site. Please use disqus below for new comments
<div style="overflow-y: scroll; max-height: 500px;">
{% render_partial functions/utf8_encode/_comments.html %}
</div>
